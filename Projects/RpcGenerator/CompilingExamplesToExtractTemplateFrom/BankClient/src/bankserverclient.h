#ifndef BANKSERVERCLIENT_H
#define BANKSERVERCLIENT_H

#include "AutoGeneratedRpcBankServerClientCode/irpcbankserverclientbusiness.h"

class BankServerClient : public IRpcBankServerClientBusiness
{
    Q_OBJECT
public:
    BankServerClient();
    void instructBackendObjectsToClaimRelevantDispensers();
    void moveBackendBusinessObjectsToTheirOwnThreadsAndStartTheThreads();
    void connectRpcBankServerSignalsToBankServerClientImplSlots(IEmitRpcBankServerBroadcastAndActionResponseSignalsWithMessageAsParam *signalEmitter);
private:
    //these dispensers will be in backend objects once i think of some..
    ClientCreateBankAccountMessageDispenser *m_CreateBankAccountMessageDispenser;
    ClientGetAddFundsKeyMessageDispenser *m_GetAddFundsKeyMessageDispenser;
public slots:
    void init();
    void start();
    void stop();

    //debug
    void simulateCreateBankAccountAction(QString username);
    void simulateGetAddFundsKeyAction(QString username);
private slots:
    //Actions Responses
    void handleCreateBankAccountCompleted(ClientCreateBankAccountMessage *createBankAccountMessage);
    void handleGetAddFundsKeyCompleted(ClientGetAddFundsKeyMessage *getAddFundsKeyMessage);

    //Action Errors
    void handleCreateBankAccountFailedUsernameAlreadyExists(ClientCreateBankAccountMessage *createBankAccountMessage);
    void handleCreateBankAccountFailedPersistError(ClientCreateBankAccountMessage *createBankAccountMessage);
    void handleGetAddFundsKeyFailedUsernameDoesntExist(ClientGetAddFundsKeyMessage *getAddFundsKeyMessage);
    void handleGetAddFundsKeyFailedUseExistingKeyFirst(ClientGetAddFundsKeyMessage *getAddFundsKeyMessage);
    void handleGetAddFundsKeyFailedWaitForPendingToBeConfirmed(ClientGetAddFundsKeyMessage *getAddFundsKeyMessage);

    //Broadcasts
    void handlePendingBalanceDetected(ClientPendingBalanceDetectedMessage *pendingBalanceDetectedMessage);
    void handleConfirmedBalanceDetected(ClientConfirmedBalanceDetectedMessage *confirmedBalanceDetectedMessage);
};

#endif // BANKSERVERCLIENT_H
